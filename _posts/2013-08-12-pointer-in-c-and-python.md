---
layout: post
title:  无处不在的指针
date:   2013-08-12
excerpt: 我相信其他象我一样从 Python 或者其他高级语言转到 C 语言的朋友一开始都会有这样的疑问：“为什么要这么麻烦的使用指针呢？Python 从来没有指针的概念，不也挺好的吗？”
---
最近在学习 OS X 和 iOS 编程，iOS 和 OS X 所使用的编程语言是 Objective－C，是一种基于 C 语言的面向对象编程语言。

C 语言对我来说是个新东西，因为我以前学的是 Python，两者给我感觉最大的区别就在于 C 语言中引入了指针（Pointer）的概念。

**C 语言中，指针是一种特殊的变量，专门用来保存其他变量在内存中的地址。**

我相信其他象我一样从 Python 或者其他高级语言转到 C 语言的朋友一开始都会有这样的疑问：“为什么要这么麻烦的使用指针呢？Python 从来没有指针的概念，不也挺好的吗？”

的确，Python 作为一种高级语言，是无需程序员手动声明指针的，它会自动帮你管理内存。虽然这多少会影响程序的运行效率，但是却为程序员节省了大量的时间。

但是没有指针概念不代表 Python 中的指针不存在，下面的例子就很好的说明了，在 Python 中，指针也是无处不在的。

{% highlight python %}

\>>> result = [[0,0]] * 3

\>>> result

[[0, 0], [0, 0], [0, 0]]

\>>> result[0][0] = 3

\>>> result

[[3, 0], [3, 0], [3, 0]]

{% endhighlight %}

看到上面的输出会感觉很奇怪吧？因为你预想中的结果应该是 [[3, 0], [0, 0], [0, 0]]，而不是象输出的结果这样三个元素同步变化的。那么只有一种可能，那就是 result 这个 list 中的三个元素，其实指向的是同一个 list 对象。

为了验证这个猜测，我们使用 id() 函数来查看这个 result 中每个元素的内存地址：

{% highlight python %}

\>>> id(result[0])

4483497856

\>>> id(result[1])

4483497856

\>>> id(result[2])

4483497856

{% endhighlight %}

果然，他们的内存地址都是相同的，他们果然都指向了内存中的同一个 list 对象。

那么，如果想创建一个符合我们预期，让三个元素是三个不同的 list 对象呢？请查看下面的代码：

{% highlight python %}

\>>> newlist = [[1,2] for i in range(3)]

\>>> newlist

[[1, 2], [1, 2], [1, 2]]

\>>> newlist[0][0] = 33

\>>> newlist

[[33, 2], [1, 2], [1, 2]]

\>>> id(newlist[0])

4483622744

\>>> id(newlist[1])

4483622888

\>>> id(newlist[2])

4483622960

{% endhighlight %}

看到了吗？现在这三个元素就拥有了不同的内存地址，已经是不同的 list 对象了。
